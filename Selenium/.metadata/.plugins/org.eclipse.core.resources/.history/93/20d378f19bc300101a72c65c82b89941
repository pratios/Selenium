package orangehrm_package;

import java.lang.reflect.Method;

import org.testng.annotations.Test;

public class Generic_OrangeHRM {
	
	public void Run(String ClassName, String MethodName, Object ...inputargs) {
		
		Class<?>params[]= new Class[inputargs.length];
		
		for(int i=0; i<inputargs.length; i++) {
			if(inputargs[i] instanceof String) {
				params[i] = String.class;
			}
		}
		
		try {
			Class<?> cls = Class.forName(ClassName);
			Object obj	 = cls.newInstance();
			Method m = cls.getDeclaredMethod(MethodName, params);
			m.invoke(obj, inputargs);
			
		} catch (Exception e) {
			// TODO: handle exception
			System.out.println("Exception in generic class : "+e.getMessage());
		}
			
	}
	
	
  @Test
  public void logintoOR() {
	  
	  ReadExcel_OrangeHRM obj = new ReadExcel_OrangeHRM("C:\\Users\\Pratiksha\\Documents\\Selenium\\OrangeHRM\\OrangeHRMKeywords.xlsx", "Sheet1");
	   int r = obj.getLastRowNumberOR();
	   System.out.println(r);
	   
	   for(int i=0; i<=r; i++) {
		   System.out.println(obj.getCellValueOR(1,i));
	   }
  }
}
